<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»£p Äá»“ng Lao Äá»™ng HTX</title>

    <!-- ThÃªm cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t cho xuáº¥t Word -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.37.11/docxtemplater.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.4/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: "Times New Roman", serif;
            font-size: 14px;
            line-height: 1.5;
            background: white;
            width: 210mm;
            margin: 0 auto;
            padding: 20mm;
            min-height: 297mm;
            position: relative;
        }

        .button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-family: "Times New Roman", serif;
        }

        .print-button {
            background-color: #4CAF50;
            color: white;
        }

        .print-button:hover {
            background-color: #45a049;
        }

        .export-button {
            background-color: #2b579a;
            color: white;
        }

        .export-button:hover {
            background-color: #1e3f6f;
        }

        #loading-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 5px;
            z-index: 2000;
        }

        .hidden {
            display: none;
        }

        /* Document header styling */
        .document-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .header-left {
            font-weight: bold;
            font-size: 14px;
            width: 45%;
        }

        .header-left .org-name {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .header-right {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            width: 50%;
        }

        .header-right .country {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .header-right .motto {
            text-decoration: underline;
            font-style: italic;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .header-right .location-date {
            font-style: italic;
            font-weight: normal;
        }

        /* Title styling */
        .document-title {
            text-align: center;
            margin: 20px 0;
        }

        .title-main {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .title-sub {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        /* Legal basis */
        .legal-basis {
            margin: 15px 0;
            line-height: 1.6;
        }

        .legal-basis p {
            margin-bottom: 8px;
        }

        /* Contract parties */
        .contract-parties {
            margin: 15px 0;
            text-align: justify;
            line-height: 1.6;
        }

        .party-section {
            margin-bottom: 15px;
        }

        .party-title {
            font-weight: bold;
            margin-bottom: 8px;
        }

        .party-content p {
            margin-bottom: 6px;
        }

        /* Content styling */
        .article {
            margin: 15px 0;
            text-align: justify;
        }

        .article-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .article-content {
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .article-content p {
            margin-bottom: 6px;
        }

        .indent-content {
            margin-left: 20px;
            margin-bottom: 6px;
        }

        .sub-section {
            margin: 8px 0;
        }

        .sub-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .list-item {
            margin-left: 20px;
            margin-bottom: 6px;
        }

        /* Signature section */
        .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
        }

        .signature-left,
        .signature-right {
            width: 45%;
            text-align: center;
        }

        .signature-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .signature-name {
            font-weight: bold;
            margin-top: 80px;
        }

        @media print {
            body {
                width: 210mm;
                height: 297mm;
                margin: 0;
                padding: 20mm;
            }

            .button-container {
                display: none;
            }
        }

        @media screen {
            body {
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                margin: 20px auto;
            }
        }

        .bold {
            font-weight: bold;
        }
    </style>
</head>

<body>
    <!-- Button Container -->
    <div class="button-container">
        <button class="button print-button" onclick="window.print()">
            <i class="fas fa-print"></i> In TÃ i Liá»‡u
        </button>
        <button class="button export-button" onclick="exportToWordTemplate()">
            <i class="fas fa-file-word"></i> Xuáº¥t Word
        </button>
    </div>

    <!-- Loading Message -->
    <div id="loading-message">Äang táº£i dá»¯ liá»‡u...</div>

    <!-- Document Content -->
    <div class="document-header">
        <div class="header-left">
            <div class="org-name bold" id="ten-don-vi-upper"></div>
            <div>Sá»‘: <span id="so-van-ban">...</span></div>
        </div>
        <div class="header-right">
            <div class="country">Cá»˜NG HÃ’A XÃƒ Há»˜I CHá»¦ NGHÄ¨A VIá»†T NAM</div>
            <div class="motto">Äá»™c láº­p - Tá»± do - Háº¡nh phÃºc</div>
            <div class="location-date">
                <em><span id="tinh">Báº¯c Ninh</span>, ngÃ y <span id="ngay">...</span> thÃ¡ng <span id="thang">...</span>
                    nÄƒm <span id="nam">...</span></em>
            </div>
        </div>
    </div>

    <div class="document-title">
        <div class="title-main">Há»¢P Äá»’NG LAO Äá»˜NG</div>
        <div class="title-sub">Vá» viá»‡c kÃ½ káº¿t há»£p Ä‘á»“ng lao Ä‘á»™ng Ä‘á»‘i vá»›i nhÃ¢n viÃªn lÃ¡i xe</div>
    </div>

    <div class="legal-basis">
        <p>CÄƒn cá»© Bá»™ Luáº­t Lao Ä‘á»™ng nÄƒm 2019 vÃ  cÃ¡c vÄƒn báº£n hÆ°á»›ng dáº«n hiá»‡n hÃ nh;</p>
        <p>VÃ  sá»± thá»a thuáº­n cá»§a cÃ¡c bÃªn lÃ :</p>
    </div>

    <div class="contract-parties">
        <div class="party-section">
            <div class="party-title">A. NGÆ¯á»œI Sá»¬ Dá»¤NG LAO Äá»˜NG: <span id="ten-don-vi-a" class="bold">...</span></div>
            <div class="party-content">
                <p>Giáº¥y chá»©ng nháº­n Ä‘Äƒng kÃ½ kinh doanh sá»‘ 2301328849 do PhÃ²ng TÃ i chÃ­nh - Káº¿ hoáº¡ch thÃ nh phá»‘ Báº¯c Ninh cáº¥p ngÃ y 09/4/2025</p>
                <p>Äá»‹a chá»‰: <span id="dia-chi-don-vi">...</span></p>
                <p>Äiá»‡n thoáº¡i: <span id="so-dt">...</span> Fax:</p>
                <p>Äáº¡i diá»‡n: Ã”ng <span id="nguoi-dai-dien">...</span> - Chá»©c vá»¥: <span id="chuc-vu-nguoi-dai-dien">...</span></p>
            </div>
        </div>

        <div class="party-section">
            <div class="party-title">B. NGÆ¯á»œI LAO Äá»˜NG: Ã”NG/BÃ€ <span id="ho-ten-upper" class="bold">...</span></div>
            <div class="party-content">
                <p>NgÃ y sinh: <span id="ngay-sinh">...</span></p>
                <p>Äá»‹a chá»‰: <span id="dia-chi-nhan-su">...</span></p>
                <p>CÄƒn cÆ°á»›c cÃ´ng dÃ¢n sá»‘: <span id="so-cccd">...</span> ngÃ y cáº¥p: <span id="ngay-cap-cccd">...</span></p>
                <p>NÆ¡i cáº¥p: <span id="noi-cap-cccd">...</span></p>
            </div>
        </div>

        <p style="margin-top: 15px;">Sau khi thá»a thuáº­n, hai BÃªn thá»‘ng nháº¥t kÃ½ Há»£p Ä‘á»“ng lao Ä‘á»™ng (sau Ä‘Ã¢y gá»i lÃ  "Há»£p Ä‘á»“ng") vá»›i cÃ¡c Ä‘iá»u khoáº£n sau Ä‘Ã¢y:</p>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 1. Thá»i háº¡n vÃ  cÃ´ng viá»‡c há»£p Ä‘á»“ng</div>
        <div class="article-content">
            <div class="list-item"><strong>-</strong> Loáº¡i há»£p Ä‘á»“ng lao Ä‘á»™ng: KhÃ´ng xÃ¡c Ä‘á»‹nh thá»i háº¡n.</div>
            <div class="list-item"><strong>-</strong> Tá»« ngÃ y <span id="ngay-hieu-luc">...</span></div>
            <div class="list-item"><strong>-</strong> Äá»‹a Ä‘iá»ƒm lÃ m viá»‡c: Äiá»u khiá»ƒn xe <span id="loai-xe">...</span> biá»ƒn sá»‘: <span id="bien-so">...</span></div>
            <div class="list-item"><strong>-</strong> Chá»©c danh chuyÃªn mÃ´n: LÃ¡i xe háº¡ng <span id="hang-gplx">...</span></div>
            <div class="list-item"><strong>-</strong> Chá»©c vá»¥: <span id="chuc-vu">...</span>.</div>
            <div class="list-item"><strong>-</strong> CÃ´ng viá»‡c pháº£i lÃ m: Thá»±c hiá»‡n theo sá»± Ä‘iá»u Ä‘á»™ng, phÃ¢n cÃ´ng cá»§a HTX.</div>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 2. Cháº¿ Ä‘á»™ lÃ m viá»‡c</div>
        <div class="article-content">
            <p><strong>1. Thá»i gian lÃ m viá»‡c chÃ­nh thá»©c:</strong></p>
            <p>08 giá»/ngÃ y, tá»« Thá»© 2 Ä‘áº¿n Thá»© 7 hÃ ng tuáº§n.</p>
            <div class="list-item">- Buá»•i sÃ¡ng: Tá»« 8 giá» 00 phÃºt Ä‘áº¿n 12 giá» 00 phÃºt.</div>
            <div class="list-item">- Buá»•i chiá»u: Tá»« 13 giá» 00 phÃºt Ä‘áº¿n 17 giá» 00 phÃºt.</div>
            <p style="margin-top: 10px;"><strong>2.</strong> NgoÃ i thá»i gian lÃ m viá»‡c chÃ­nh thá»©c, theo quy Ä‘á»‹nh cá»§a Há»£p tÃ¡c xÃ£, ngÆ°á»i lao Ä‘á»™ng cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u Ä‘á»™ng Ä‘á»™t xuáº¥t theo yÃªu cáº§u cá»§a Ban GiÃ¡m Ä‘á»‘c Há»£p tÃ¡c xÃ£.</p>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 3. NghÄ©a vá»¥ vÃ  quyá»n lá»£i cá»§a ngÆ°á»i lao Ä‘á»™ng</div>

        <div class="sub-section">
            <div class="sub-title">1. Quyá»n lá»£i:</div>
            
            <p><strong>1.1. Tiá»n lÆ°Æ¡ng vÃ  cÃ¡c khoáº£n phá»¥ cáº¥p:</strong> Theo thá»a thuáº­n.</p>
            
            <p style="margin-top: 10px;"><strong>1.2. Cháº¿ Ä‘á»™ nÃ¢ng lÆ°Æ¡ng:</strong></p>
            <div class="list-item">a) Thá»i Ä‘iá»ƒm xÃ©t nÃ¢ng lÆ°Æ¡ng: NÄƒm nÄƒm xÃ©t 01(má»™t) láº§n.</div>
            <div class="list-item">b) Thá»i Ä‘iá»ƒm báº¯t Ä‘áº§u Ã¡p dá»¥ng má»©c lÆ°Æ¡ng má»›i: VÃ o ngÃ y ra quyáº¿t Ä‘á»‹nh nÃ¢ng lÆ°Æ¡ng.</div>
            <div class="list-item">c) Äiá»u kiá»‡n xem xÃ©t nÃ¢ng lÆ°Æ¡ng: TÃ¹y tÃ¬nh hÃ¬nh hoáº¡t Ä‘á»™ng kinh doanh cá»§a Há»£p tÃ¡c xÃ£ vÃ  theo quyáº¿t Ä‘á»‹nh cá»§a Ban lÃ£nh Ä‘áº¡o, Há»£p tÃ¡c xÃ£ chá»‰ xem xÃ©t nÃ¢ng lÆ°Æ¡ng cho ngÆ°á»i lao Ä‘á»™ng hoÃ n thÃ nh tá»‘t nhiá»‡m vá»¥ Ä‘Æ°á»£c giao, Ä‘Ã£ lÃ m viá»‡c táº¡i Há»£p tÃ¡c xÃ£ Ä‘á»§ thá»i gian quy Ä‘á»‹nh vÃ  khÃ´ng vi pháº¡m ká»· luáº­t vÃ /hoáº·c khÃ´ng trong thá»i gian xá»­ lÃ½ ká»· luáº­t lao Ä‘á»™ng hoáº·c nhá»¯ng trÆ°á»ng há»£p Ä‘áº·c biá»‡t sáº½ Ä‘Æ°á»£c Ban lÃ£nh Ä‘áº¡o Há»£p tÃ¡c xÃ£ xem xÃ©t quyáº¿t Ä‘á»‹nh nÃ¢ng lÆ°Æ¡ng trÆ°á»›c thá»i háº¡n.</div>
            
            <p style="margin-top: 10px;"><strong>1.3. Khen thÆ°á»Ÿng:</strong> TÃ¹y tÃ¬nh hÃ¬nh hoáº¡t Ä‘á»™ng kinh doanh cá»§a Há»£p tÃ¡c xÃ£ vÃ  theo quyáº¿t Ä‘á»‹nh cá»§a Ban lÃ£nh Ä‘áº¡o.</p>
            
            <p style="margin-top: 10px;"><strong>1.4. HÃ¬nh thá»©c tráº£ lÆ°Æ¡ng:</strong> Chuyá»ƒn khoáº£n hoáº·c tiá»n máº·t</p>
            
            <p style="margin-top: 10px;"><strong>1.5. Cháº¿ Ä‘á»™ nghá»‰ ngÆ¡i:</strong></p>
            <div class="list-item">a) Nghá»‰ hÃ ng tuáº§n: Theo quy Ä‘á»‹nh cá»§a Há»£p tÃ¡c xÃ£.</div>
            <div class="list-item">b) Nghá»‰ hÃ ng nÄƒm: NgÆ°á»i lao Ä‘á»™ng Ä‘Æ°á»£c kÃ½ há»£p Ä‘á»“ng chÃ­nh thá»©c vÃ  cÃ³ thÃ¢m niÃªn cÃ´ng tÃ¡c tá»« Ä‘á»§ 12 (mÆ°á»i hai) thÃ¡ng trá»Ÿ lÃªn sáº½ Ä‘Æ°á»£c nghá»‰ 12 (mÆ°á»i hai) ngÃ y phÃ©p trong nÄƒm vÃ  váº«n hÆ°á»Ÿng Ä‘áº§y Ä‘á»§ lÆ°Æ¡ng vá»›i Ä‘iá»u kiá»‡n nghá»‰ phÃ©p khÃ´ng quÃ¡ 02 (hai) ngÃ y liÃªn tiáº¿p vÃ  má»—i thÃ¡ng khÃ´ng quÃ¡ 02 (hai) ngÃ y phÃ©p.</div>
            <div class="list-item">c) Nghá»‰ ngÃ y lá»…: CÃ¡c ngÃ y Lá»…, Táº¿t theo quy Ä‘á»‹nh cá»§a Há»£p tÃ¡c xÃ£ vÃ  NhÃ  nÆ°á»›c.</div>
            
            <p style="margin-top: 10px;"><strong>1.6. Cháº¿ Ä‘á»™ báº£o hiá»ƒm xÃ£ há»™i:</strong> Theo quy Ä‘á»‹nh cá»§a Há»£p tÃ¡c xÃ£ vÃ  NhÃ  nÆ°á»›c.</p>
        </div>

        <div class="sub-section">
            <div class="sub-title">2. NghÄ©a vá»¥:</div>
            <div class="list-item"><strong>2.1.</strong> LÃ¡i xe cÃ³ trÃ¡ch nhiá»‡m báº£o quáº£n, giá»¯ gÃ¬n xe Ã´ tÃ´ luÃ´n sáº¡ch sáº½, sá»­ dá»¥ng an toÃ n, Ä‘Ãºng má»¥c Ä‘Ã­ch. CÃ³ trÃ¡ch nhiá»‡m tuÃ¢n thá»§ Luáº­t giao thÃ´ng hiá»‡n hÃ nh vÃ  cÃ¡c vÄƒn báº£n hÆ°á»›ng dáº«n thi hÃ nh, thá»±c hiá»‡n lá»™ trÃ¬nh cÃ´ng tÃ¡c vá»›i tinh tháº§n trÃ¡ch nhiá»‡m cao nháº¥t.</div>
            <div class="list-item"><strong>2.2.</strong> LuÃ´n thá»ƒ hiá»‡n pháº©m cháº¥t trung thá»±c, thÃ¡i Ä‘á»™ phá»¥c vá»¥ niá»m ná»Ÿ, lá»‹ch sá»±, nhiá»‡t tÃ¬nh, Ä‘áº£m báº£o Ä‘Ã¡p á»©ng thá»i gian cÃ´ng tÃ¡c khi Ä‘Æ°á»£c Ä‘iá»u Ä‘á»™ng Ä‘á»™t xuáº¥t.</div>
            <div class="list-item"><strong>2.3.</strong> HoÃ n thÃ nh nhá»¯ng cÃ´ng viá»‡c Ä‘Ã£ cam káº¿t trong há»£p Ä‘á»“ng lao Ä‘á»™ng nÃ y vÃ  táº¥t cáº£ cÃ¡c nhiá»‡m vá»¥ trong pháº¡m vi mÃ´ táº£ cÃ´ng viá»‡c.</div>
            <div class="list-item"><strong>2.5.</strong> CÃ¡c nghÄ©a vá»¥ khÃ¡c theo quy Ä‘á»‹nh táº¡i ná»™i quy cá»§a há»£p tÃ¡c xÃ£.</div>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 4. NghÄ©a vá»¥ vÃ  quyá»n háº¡n cá»§a ngÆ°á»i sá»­ dá»¥ng lao Ä‘á»™ng</div>

        <div class="sub-section">
            <div class="sub-title">1. NghÄ©a vá»¥:</div>
            <div class="list-item">a) Báº£o Ä‘áº£m viá»‡c lÃ m vÃ  thá»±c hiá»‡n Ä‘áº§y Ä‘á»§ nhá»¯ng Ä‘iá»u Ä‘Ã£ cam káº¿t trong há»£p Ä‘á»“ng lao Ä‘á»™ng.</div>
            <div class="list-item">b) Thanh toÃ¡n Ä‘áº§y Ä‘á»§, Ä‘Ãºng háº¡n cÃ¡c cháº¿ Ä‘á»™ vÃ  quyá»n lá»£i cho NgÆ°á»i lao Ä‘á»™ng theo há»£p Ä‘á»“ng lao Ä‘á»™ng, ná»™i quy lao Ä‘á»™ng vÃ  thá»a thuáº­n lao Ä‘á»™ng táº­p thá»ƒ (náº¿u cÃ³).</div>
        </div>

        <div class="sub-section">
            <div class="sub-title">2. Quyá»n háº¡n:</div>
            <div class="list-item">a) Giao nhiá»‡m vá»¥ vÃ  Ä‘iá»u hÃ nh ngÆ°á»i lao Ä‘á»™ng hoÃ n thÃ nh cÃ´ng viá»‡c theo há»£p Ä‘á»“ng lao Ä‘á»™ng Ä‘Ã£ kÃ½ káº¿t.</div>
            <div class="list-item">b) CÃ³ quyá»n Ä‘iá»u chuyá»ƒn táº¡m thá»i lao Ä‘á»™ng, ngá»«ng viá»‡c thay Ä‘á»•i, táº¡m hoÃ£n, cháº¥m dá»©t Há»£p Ä‘á»“ng lao Ä‘á»™ng, Ã¡p dá»¥ng cÃ¡c hÃ¬nh thá»©c xá»­ lÃ½ ká»· luáº­t, .... Ä‘á»‘i vá»›i ngÆ°á»i lao Ä‘á»™ng theo ná»™i quy cá»§a HTX, thá»a Æ°á»›c lao Ä‘á»™ng táº­p thá»ƒ (náº¿u cÃ³) vÃ  quy Ä‘á»‹nh cá»§a PhÃ¡p luáº­t hiá»‡n hÃ nh.</div>
            <div class="list-item">c) YÃªu cáº§u ngÆ°á»i lao Ä‘á»™ng cung cáº¥p má»i thÃ´ng tin liÃªn quan Ä‘áº¿n cÃ´ng viá»‡c cá»§a ngÆ°á»i lao Ä‘á»™ng theo Há»£p Ä‘á»“ng nÃ y.</div>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 5. Cháº¥m dá»©t há»£p Ä‘á»“ng lao Ä‘á»™ng</div>
        <div class="article-content">
            <p><strong>1.</strong> NgÆ°á»i lao Ä‘á»™ng vÃ  ngÆ°á»i sá»­ dá»¥ng lao Ä‘á»™ng cÃ³ quyá»n Ä‘Æ¡n phÆ°Æ¡ng cháº¥m dá»©t há»£p Ä‘á»“ng lao Ä‘á»™ng trÆ°á»›c háº¡n vÃ  pháº£i tuÃ¢n thá»§ theo quy Ä‘á»‹nh cá»§a Bá»™ luáº­t Lao Ä‘á»™ng vÃ  cÃ¡c quy Ä‘á»‹nh cá»§a phÃ¡p luáº­t hiá»‡n hÃ nh.</p>
            <p style="margin-top: 10px;"><strong>2.</strong> TrÆ°á»ng há»£p ngÆ°á»i lao Ä‘á»™ng vi pháº¡m ná»™i quy há»£p tÃ¡c xÃ£, vi pháº¡m quy Ä‘á»‹nh cá»§a phÃ¡p luáº­t thÃ¬ HTX sáº½ Ã¡p dá»¥ng hÃ¬nh thá»©c ká»· luáº­t sa tháº£i theo quy Ä‘á»‹nh táº¡i cá»§a Bá»™ luáº­t Lao Ä‘á»™ng vÃ  phÃ¡p luáº­t hiá»‡n hÃ nh.</p>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 6. Thá»a thuáº­n khÃ¡c</div>
        <div class="article-content">
            <p><strong>1.</strong> Trong quÃ¡ trÃ¬nh thá»±c hiá»‡n há»£p Ä‘á»“ng náº¿u má»™t bÃªn cÃ³ nhu cáº§u thay Ä‘á»•i ná»™i dung trong Há»£p Ä‘á»“ng thÃ¬ pháº£i bÃ¡o trÆ°á»›c cho bÃªn kia vÃ  kÃ½ káº¿t báº£n Phá»¥ lá»¥c Há»£p Ä‘á»“ng theo quy Ä‘á»‹nh cá»§a phÃ¡p luáº­t. Trong thá»i gian tiáº¿n hÃ nh thá»a thuáº­n hai BÃªn váº«n tuÃ¢n thá»§ theo Há»£p Ä‘á»“ng lao Ä‘á»™ng Ä‘Ã£ kÃ½ káº¿t.</p>
            <p style="margin-top: 10px;"><strong>2.</strong> NgÆ°á»i lao Ä‘á»™ng Ä‘á»c ká»¹, hiá»ƒu rÃµ vÃ  cam káº¿t thá»±c hiá»‡n cÃ¡c Ä‘iá»u khoáº£n vÃ  quy Ä‘á»‹nh ghi táº¡i Há»£p Ä‘á»“ng nÃ y.</p>
            <p style="margin-top: 10px;"><strong>3.</strong> TrÆ°á»ng há»£p xáº£y ra tranh cháº¥p hai BÃªn sáº½ cÃ¹ng giáº£i quyáº¿t thÃ´ng qua thÆ°Æ¡ng lÆ°á»£ng, hÃ²a giáº£i trong vÃ²ng 30 ngÃ y ká»ƒ tá»« ngÃ y xáº£y ra tranh cháº¥p Ä‘Ã³. Náº¿u khÃ´ng thá»ƒ hÃ²a giáº£i Ä‘Æ°á»£c, má»™t trong hai BÃªn cÃ³ quyá»n Ä‘Æ°a vá»¥ viá»‡c ra giáº£i quyáº¿t táº¡i TÃ²a Ã¡n cÃ³ tháº©m quyá»n cá»§a Viá»‡t Nam.</p>
        </div>
    </div>

    <div class="article">
        <div class="article-title">Äiá»u 7. Äiá»u khoáº£n thi hÃ nh</div>
        <div class="article-content">
            <p><strong>1.</strong> Nhá»¯ng váº¥n Ä‘á» vá» lao Ä‘á»™ng khÃ´ng ghi trong Há»£p Ä‘á»“ng lao Ä‘á»™ng nÃ y thÃ¬ Ã¡p dá»¥ng theo Thá»a Æ°á»›c lao Ä‘á»™ng táº­p thá»ƒ (náº¿u cÃ³), ná»™i quy lao Ä‘á»™ng vÃ  phÃ¡p luáº­t hiá»‡n hÃ nh.</p>
            <p style="margin-top: 10px;"><strong>2.</strong> Há»£p Ä‘á»“ng nÃ y Ä‘Æ°á»£c láº­p thÃ nh 02 (hai) báº£n cÃ³ giÃ¡ trá»‹ nhÆ° nhau, HÃ nh chÃ­nh nhÃ¢n sá»± giá»¯ 01(má»™t) báº£n, NgÆ°á»i lao Ä‘á»™ng giá»¯ 01 (má»™t) báº£n vÃ  cÃ³ hiá»‡u lá»±c ká»ƒ tá»« ngÃ y kÃ½ káº¿t há»£p Ä‘á»“ng.</p>
            <p style="margin-top: 10px;"><strong>3.</strong> Há»£p Ä‘á»“ng nÃ y Ä‘Æ°á»£c láº­p ngÃ y <span id="ngay-footer">...</span> thÃ¡ng <span id="thang-footer">...</span> nÄƒm <span id="nam-footer">...</span> táº¡i trá»¥ sá»Ÿ cá»§a Há»£p tÃ¡c xÃ£ váº­n táº£i Gia Linh.</p>
        </div>
    </div>

    <div class="signature-section">
        <div class="signature-left">
            <div class="signature-title">NGÆ¯á»œI LAO Äá»˜NG</div>
            <div class="signature-name" id="ho-ten-signature">...</div>
        </div>
        <div class="signature-right">
            <div class="signature-title">NGÆ¯á»œI Sá»¬ Dá»¤NG LAO Äá»˜NG</div>
            <div class="signature-name" id="nguoi-dai-dien-signature">...</div>
        </div>
    </div>

    <script>
        // Constants for AppSheet connection
        const appId = '4382b705-5dcf-4dfa-817a-55dd6173eafa';
        const accessKey = 'V2-huCGu-Kk2Rx-ysqBu-DpsaC-bmou2-9XklX-nHDzA-0KGsl';
        const region = 'www';

        // Biáº¿n toÃ n cá»¥c Ä‘á»ƒ lÆ°u dá»¯ liá»‡u
        let globalContractData = null;

        // Function to get IDHoSo from URL
        function getIDHoSoFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('IDHoSo') || urlParams.get('idhoso');
        }

        // Function to fetch data from AppSheet
        async function fetchAppSheetData(tableName, filter = null) {
            try {
                const selector = filter || `Filter(${tableName}, true)`;
                console.log(`ğŸ” Executing selector for ${tableName}:`, selector);

                const body = {
                    Action: 'Find',
                    Properties: {},
                    Selector: selector
                };

                const response = await fetch(`https://${region}.appsheet.com/api/v2/apps/${appId}/tables/${tableName}/Action`, {
                    method: 'POST',
                    headers: {
                        'ApplicationAccessKey': accessKey,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log(`ğŸ” Response for ${tableName}:`, data);
                return Array.isArray(data) ? data : [];
            } catch (error) {
                console.error(`Failed to fetch ${tableName}:`, error);
                throw error;
            }
        }

        // Format date tá»« Date thÃ nh dd/mm/yyyy
        function formatDateShort(dateString) {
            if (!dateString || dateString === '') {
                return '';
            }

            let date;
            if (typeof dateString === 'string') {
                if (dateString.includes('/')) {
                    const parts = dateString.split('/');
                    if (parts.length === 3) {
                        const day = parseInt(parts[0]);
                        const month = parseInt(parts[1]);
                        const year = parseInt(parts[2]);
                        date = new Date(year, month - 1, day);
                    }
                } else if (dateString.includes('-')) {
                    date = new Date(dateString);
                } else {
                    date = new Date(dateString);
                }
            } else if (dateString instanceof Date) {
                date = dateString;
            } else {
                return dateString.toString();
            }

            if (isNaN(date.getTime())) {
                return dateString.toString();
            }

            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();

            return `${day}/${month}/${year}`;
        }

        // Format date Ä‘áº§y Ä‘á»§ cho ngÃ y hiá»‡u lá»±c
        function formatDateFull(dateString) {
            console.log('ğŸ” formatDateFull input:', dateString, typeof dateString);

            if (!dateString || dateString === '') {
                return '';
            }

            let date;

            // AppSheet tráº£ vá» MM/DD/YYYY format
            if (typeof dateString === 'string' && dateString.includes('/')) {
                const parts = dateString.split('/');
                if (parts.length === 3) {
                    const month = parseInt(parts[0]);
                    const day = parseInt(parts[1]);
                    const year = parseInt(parts[2]);

                    date = new Date(year, month - 1, day);
                    console.log('ğŸ” Parsed from MM/DD/YYYY:', `${month}/${day}/${year} â†’ ${date}`);
                }
            } else {
                date = new Date(dateString);
            }

            if (!date || isNaN(date.getTime())) {
                console.log('âŒ Invalid date:', dateString);
                return dateString.toString();
            }

            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();

            const result = `${day.toString().padStart(2, '0')} thÃ¡ng ${month} nÄƒm ${year}`;
            console.log('âœ… Final formatted:', result);

            return result;
        }

        // Get current date components
        function getCurrentDateComponents(ngayKy) {
            if (ngayKy) {
                try {
                    let date = null;

                    if (typeof ngayKy === 'string' && ngayKy.includes('/')) {
                        const parts = ngayKy.split('/');
                        if (parts.length === 3) {
                            const month = parseInt(parts[0], 10);
                            const day = parseInt(parts[1], 10);
                            const year = parseInt(parts[2], 10);
                            date = new Date(year, month - 1, day);
                        }
                    } else {
                        date = new Date(ngayKy);
                    }

                    if (date && !isNaN(date.getTime())) {
                        return {
                            day: date.getDate().toString().padStart(2, '0'),
                            month: date.getMonth() + 1,
                            year: date.getFullYear()
                        };
                    }
                } catch (e) {
                    console.warn('KhÃ´ng parse Ä‘Æ°á»£c NgayKy, sáº½ dÃ¹ng ngÃ y hiá»‡n táº¡i', e);
                }
            }

            const today = new Date();
            return {
                day: today.getDate().toString().padStart(2, '0'),
                month: today.getMonth() + 1,
                year: today.getFullYear()
            };
        }

        // Extract province from address
        function extractProvince(address) {
            if (!address) return 'Báº¯c Ninh';
            const provincePrefixes = ['Tá»‰nh ', 'ThÃ nh phá»‘ ', 'TP. ', 'T.P '];
            const parts = address.split(',');
            let lastPart = parts[parts.length - 1].trim();

            for (const prefix of provincePrefixes) {
                if (lastPart.startsWith(prefix)) {
                    lastPart = lastPart.substring(prefix.length).trim();
                    break;
                }
            }

            return lastPart || 'Báº¯c Ninh';
        }

        // Load data from AppSheet
        async function loadData() {
            try {
                const idHoSo = getIDHoSoFromURL();
                console.log('ğŸ” ID tá»« URL:', idHoSo);

                if (!idHoSo) {
                    throw new Error('KhÃ´ng tÃ¬m tháº¥y IDHoSo trong URL');
                }

                const [hosoList, donviList, xeList, nhansuList] = await Promise.all([
                    fetchAppSheetData('HOSONHANSU', `Filter(HOSONHANSU, [IDHoSo] = "${idHoSo}")`),
                    fetchAppSheetData('THONGTINDONVI'),
                    fetchAppSheetData('THONGTINXE'),
                    fetchAppSheetData('THONGTINNHANSU')
                ]);

                if (!hosoList || hosoList.length === 0) {
                    throw new Error('KhÃ´ng tÃ¬m tháº¥y há»“ sÆ¡ vá»›i ID nÃ y');
                }

                const hosoData = hosoList.find(item => item.IDHoSo === idHoSo);
                if (!hosoData) {
                    throw new Error(`KhÃ´ng tÃ¬m tháº¥y ID "${idHoSo}"`);
                }

                const donviData = donviList.length > 0 ? donviList[0] : {};
                const xeData = hosoData.Ref_Xe ?
                    xeList.find(x => x.Idxe === hosoData.Ref_Xe) || {} : {};
                const nhansuData = hosoData.Ref_ThanhVien ?
                    nhansuList.find(n => n.IDNS === hosoData.Ref_ThanhVien) || {} : {};

                const currentDate = getCurrentDateComponents(hosoData.NgayKy);

                // LÆ°u dá»¯ liá»‡u cho xuáº¥t Word
                globalContractData = {
                    IDHoSo: hosoData.IDHoSo || '',
                    SoVanBan: hosoData.SoVanBan || '',
                    Tendonvi: donviData.Tendonvi || '',
                    Tendonvi_Uper: (donviData.Tendonvi || '').toUpperCase(),
                    Nguoidaidien: donviData.Nguoidaidien || '',
                    ChucvuNguoidaidien: donviData.ChucvuNguoidaidien || '',
                    Hoten: nhansuData.Hoten || '',
                    Hoten_Uper: (nhansuData.Hoten || '').toUpperCase(),
                    Ngaysinh: formatDateShort(nhansuData.Ngaysinh),
                    SoCCCD: nhansuData.NoCCCD || '',
                    NgayCapCCCD: formatDateShort(nhansuData.NgayCapCCCD),
                    NoicapCCCD: nhansuData.NoicapCCCD || 'Cá»¥c Cáº£nh sÃ¡t ÄKQL cÆ° trÃº vÃ  DLQG vá» dÃ¢n cÆ°',
                    SoGPLX: nhansuData.SoGPLX || '',
                    Diachi: donviData.Diachi || '',
                    Diachidaydu: nhansuData.Diachidaydu || '',
                    Loaixe: xeData.Loaixe || '',
                    Bienso: xeData.Bienso || '',
                    SoDT: donviData.SoDT || '',
                    HangGPLX: nhansuData['Háº¡ng GPLX'] || '',
                    Chucvu: nhansuData.Chucvu || '',
                    NgayHieuLuc_dai: formatDateFull(hosoData.NgayHieuLuc || ''),
                    Tinh: extractProvince(nhansuData.Diachidaydu),
                    Ngay: currentDate.day,
                    Thang: currentDate.month === 1 || currentDate.month === 2 ?
                        currentDate.month.toString().padStart(2, '0') : currentDate.month.toString(),
                    Nam: currentDate.year
                };

                populateHTML(globalContractData);
                hideLoadingMessage();

            } catch (error) {
                console.error('Error loading data:', error);
                hideLoadingMessage();
                alert('Lá»—i: ' + error.message);
            }
        }

        // Populate HTML with data
        function populateHTML(data) {
            const setText = (id, value) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value || '';
                }
            };

            setText('ten-don-vi-upper', data.Tendonvi_Uper);
            setText('so-van-ban', data.SoVanBan);
            setText('tinh', data.Tinh);
            setText('ngay', data.Ngay);
            setText('thang', data.Thang);
            setText('nam', data.Nam);
            setText('ten-don-vi-a', data.Tendonvi_Uper);
            setText('dia-chi-don-vi', data.Diachi);
            setText('so-dt', data.SoDT);
            setText('nguoi-dai-dien', data.Nguoidaidien);
            setText('chuc-vu-nguoi-dai-dien', data.ChucvuNguoidaidien);
            setText('ho-ten-upper', data.Hoten_Uper);
            setText('ngay-sinh', data.Ngaysinh);
            setText('dia-chi-nhan-su', data.Diachidaydu);
            setText('so-cccd', data.SoCCCD);
            setText('ngay-cap-cccd', data.NgayCapCCCD);
            setText('noi-cap-cccd', data.NoicapCCCD);
            setText('ngay-hieu-luc', data.NgayHieuLuc_dai);
            setText('loai-xe', data.Loaixe);
            setText('bien-so', data.Bienso);
            setText('hang-gplx', data.HangGPLX);
            setText('chuc-vu', data.Chucvu);
            setText('ngay-footer', data.Ngay);
            setText('thang-footer', data.Thang);
            setText('nam-footer', data.Nam);
            setText('ho-ten-signature', data.Hoten);
            setText('nguoi-dai-dien-signature', data.Nguoidaidien);
        }

        // Export to Word template
        async function exportToWordTemplate() {
            try {
                if (!globalContractData) {
                    alert('Dá»¯ liá»‡u chÆ°a Ä‘Æ°á»£c táº£i. Vui lÃ²ng Ä‘á»£i dá»¯ liá»‡u táº£i xong.');
                    return;
                }

                document.getElementById('loading-message').style.display = 'block';
                document.getElementById('loading-message').textContent = 'Äang xuáº¥t file Word...';

                const templateUrl = 'https://poalninh.github.io/templates/templates/hdld_gialinh_template.docx';

                const response = await fetch(templateUrl);
                if (!response.ok) {
                    throw new Error('KhÃ´ng thá»ƒ táº£i template Word');
                }

                const templateContent = await response.arrayBuffer();
                const zip = new PizZip(templateContent);
                const doc = new window.docxtemplater(zip, {
                    paragraphLoop: true,
                    linebreaks: true
                });

                doc.setData(globalContractData);
                doc.render();
                const blob = doc.getZip().generate({
                    type: "blob",
                    mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                });

                const fileName = `HopDongLaoDong_${globalContractData.Hoten || 'Document'}.docx`;
                saveAs(blob, fileName);

                hideLoadingMessage();

            } catch (error) {
                console.error('Lá»—i xuáº¥t file Word:', error);
                alert('CÃ³ lá»—i xáº£y ra khi xuáº¥t file Word: ' + error.message);
                hideLoadingMessage();
            }
        }

        // Hide loading message
        function hideLoadingMessage() {
            document.getElementById('loading-message').classList.add('hidden');
        }

        // Initialize application
        async function initialize() {
            try {
                const idHoSo = getIDHoSoFromURL();
                if (!idHoSo) {
                    alert('Vui lÃ²ng cung cáº¥p IDHoSo trong URL. VÃ­ dá»¥: ?IDHoSo=HS001');
                    return;
                }
                await loadData();
            } catch (error) {
                console.error('Initialization error:', error);
                alert('KhÃ´ng thá»ƒ káº¿t ná»‘i vá»›i há»‡ thá»‘ng. Vui lÃ²ng thá»­ láº¡i sau.');
            }
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(() => {
                initialize();
            }, 500);
        });

        // Disable right-click and F12
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        }, false);

        document.onkeydown = function (e) {
            if (e.keyCode == 123) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        };
    </script>
</body>

</html>